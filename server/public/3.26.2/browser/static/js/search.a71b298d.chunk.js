"use strict";(self.webpackChunk_itv_fe_cassandra=self.webpackChunk_itv_fe_cassandra||[]).push([[6464],{64344:function(e,r,t){t.d(r,{Z:function(){return s}});var n=t(16363),a=t(9673),o=t(53357);var s=function(){var e=(0,a.Z)(),r=(0,n.k6)(),t=(0,o.d)().toggleExitDialog;return{handleBackTo:function(){e.get("fromDeepLink")?t():r.goBack()}}}},38082:function(e,r,t){t.r(r),t.d(r,{default:function(){return W}});var n=t(64628),a=t(6964),o=t(5073),s=t(16363),l=t(98830),c=t(12642),i=t.n(c),u=t(64344),d=t(32666),h=t(26733),p=t(33028),m=t(75787),g=t(23640),f=t(58091),v=t(86367),E=t(855),y=t(89626),b=t.n(y),S=t(28612),P=t(25931),w=t(47828),R=t(89730),k=t(56865),T={horizontal:0,vertical:350},C=function(e){var r,t,a,o,s=e.id,l=e.programmes,c=e.searchPhrase,i=(0,n.useCallback)((function(){(0,v.cptSend)({event:E.CptEvents.SEARCH_CLICK_EVENT,search:{keyword:c.toUpperCase(),results:l.length,type:E.CptSearchType.FREE_TEXT}})}),[l,c]);return null!==l&&void 0!==l&&l.length?n.createElement(w.Z,{id:s,className:"SearchSlider",activeFocusId:(null===(r=l[0])||void 0===r||null===(t=r.encodedEpisodeId)||void 0===t?void 0:t.letterA)||(null===(a=l[0])||void 0===a||null===(o=a.encodedProgrammeId)||void 0===o?void 0:o.letterA),backToMemory:!0,optimiseRenders:!0,items:l.map((function(e,r){var t=e.encodedEpisodeId,a=e.encodedProgrammeId,o=e.programmeId,s=e.channel,l=e.episodeCount,u=e.entityType;return n.createElement(R.Z,{id:(null===t||void 0===t?void 0:t.letterA)||(null===a||void 0===a?void 0:a.letterA),key:(null===t||void 0===t?void 0:t.letterA)||(null===a||void 0===a?void 0:a.letterA),link:(0,k.Z)({entityType:u,programmeId:o,encodedProgrammeId:a}),programme:e,contentType:"programme",position:r,channel:s,episodeCount:l,searchPhrase:c,throttle:T,onClick:i})}))}):null};C.propTypes={programmes:b().arrayOf(b().shape({encodedEpisodeId:b().shape({letterA:b().string,underscore:b().string}),encodedProgrammeId:b().shape({letterA:b().string,underscore:b().string}),programmeId:b().string})).isRequired,searchPhrase:b().string.isRequired,id:b().string.isRequired};var I=C,O=function(e){var r=e.searchPhrase,t=e.programmes;return n.createElement("section",{className:"SearchResults"},n.createElement(P.ZP,{element:"h3",className:"SearchResults__header"},t.length," Result",1===t.length?"":"s"," for - ",r),n.createElement(S.Z,null,n.createElement(I,{id:"SearchSlider",key:"SearchSlider-".concat(t.length,"-").concat(r),programmes:t,searchPhrase:r,rowType:"slider",height:209})))};O.propTypes={searchPhrase:b().string.isRequired,programmes:b().arrayOf(b().shape({encodedEpisodeId:b().shape({letterA:b().string,underscore:b().string})})).isRequired};var A=O,_=function(){return n.createElement("div",{className:"NoSearchResults"},n.createElement(P.ZP,{element:"h2",className:"NoSearchResults__heading"},"No search results found"),n.createElement("p",null,"Try again or browse through our page"))},j=t(3243),N=t(91335),Z=[{regularExpression:new RegExp("[^a-zA-Z0-9 ]+","g"),replacement:""},{regularExpression:new RegExp("\\s{2,}","g"),replacement:" "}],x=function(e){var r=e.searchPhrase;return r?Z.reduce((function(e,r){var t=r.regularExpression,n=r.replacement;return e.replace(t,n)}),r).trim():r},F="searchTerm",M=t(33782),D=t(64839),H=function(e){var r=e.textSearchEnabled,t=e.searchPhrase.substring(0,15),n=r?M.w7.textSearch.getSearchItems:M.IH.discovery.getAllProgrammes,a=r?[{platform:"CTV",searchTerm:t}]:void 0,o=r?[t]:void 0,s=(0,D.Z)({cerberusMethod:n,args:a},o);return{searchResults:s.result,loading:s.loading,networkError:s.networkError}};function L(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function V(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?L(Object(t),!0).forEach((function(r){q(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):L(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function q(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function B(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var t=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,a,o=[],s=!0,l=!1;try{for(t=t.call(e);!(s=(n=t.next()).done)&&(o.push(n.value),!r||o.length!==r);s=!0);}catch(c){l=!0,a=c}finally{try{s||null==t.return||t.return()}finally{if(l)throw a}}return o}(e,r)||function(e,r){if(!e)return;if("string"===typeof e)return U(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return U(e,r)}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function U(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var z=function(){var e=(0,s.TH)(),r=(0,s.k6)(),t=(0,N.useDevice)().hasFeature,a=B((0,n.useState)(new URLSearchParams(e.search)),1)[0],o=B((0,n.useState)(a.get(F)||""),2),l=o[0],c=o[1],i=t("textSearch"),u=H({textSearchEnabled:i,searchPhrase:l}),d=u.searchResults,h=u.loading,p=u.networkError,m=(0,n.useMemo)((function(){var e=new j.search.SearchEngine;return e.addRule(j.search.rules.IgnoreSpecialCharacters),e.addRule(j.search.rules.FindFirstMatch),e.addRule(j.search.rules.PrioritizeWord),e}),[]);(0,n.useEffect)((function(){d&&!i&&m.setList(d)}),[d,m,i]);var g,f=(0,n.useCallback)((function(e){c(x({searchPhrase:e})),e?a.set(F,e):a.delete(F);var t=a.toString();r.replace({search:t?"?".concat(t):void 0})}),[r,a]),v={programmes:null,showResults:!1,showNoResultsMessage:Boolean(!d&&l),loading:h,updateSearchPhrase:f,searchPhrase:l,networkError:p};return l&&(null===d||void 0===d?void 0:d.length)>0?(g=i?d:m.search(l,"title"),V(V({},v),{},{programmes:g,showResults:g.length>0&&!h,showNoResultsMessage:0===g.length})):v},K=function(){var e=(0,s.k6)(),r=z(),t=r.loading,a=r.programmes,o=r.showResults,c=r.searchPhrase,y=r.updateSearchPhrase,b=r.showNoResultsMessage,S=r.networkError,P=(0,u.Z)().handleBackTo;return(0,n.useEffect)((function(){return function(){var r,t=null===e||void 0===e||null===(r=e.location)||void 0===r?void 0:r.pathname;(o||b||"/search"!==t)&&(0,v.cptSend)({event:E.CptEvents.SEARCH_CLICK_EVENT,search:{keyword:null===c||void 0===c?void 0:c.toUpperCase(),results:(null===a||void 0===a?void 0:a.length)||0,type:E.CptSearchType.FREE_TEXT}})}}),[o,b,a]),S?n.createElement(m.Z,null):n.createElement("div",{className:i()("SearchContent",g.gridWrapper)},n.createElement(l.default,{orientation:"column",jumpToLastFocus:!0},n.createElement(l.default,{optimiseRenders:!0,jumpToLastFocus:!0},n.createElement("section",{className:"SearchContent__keyboard-section"},n.createElement(d.Z,{backTo:P,placeholder:"Search for shows on ITV Hub",onChangeValue:y,defaultValue:c||void 0}))),n.createElement(h.r,{backTo:f.v0},o&&n.createElement(A,{searchPhrase:c,programmes:a}),b&&n.createElement(_,null)),t&&n.createElement(p.default,null)))},W=function(){return n.createElement(a.default,{trackingPageType:o.c6.SEARCH,trackingPageId:o.c7.SEARCH,trackingRoute:"search"},n.createElement(K,null))}}}]);
//# sourceMappingURL=search.a71b298d.chunk.js.map